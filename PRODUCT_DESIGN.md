# Curve äº§å“æ¡†æ¶è®¾è®¡æ–‡æ¡£

> æœ¬æ–‡æ¡£è¯¦ç»†æè¿° Curve ç§‘ç ” AI å¯¹è¯å¹³å°çš„äº§å“æ¶æ„ã€åŠŸèƒ½æ¨¡å—ã€äº¤äº’é€»è¾‘ä¸ UI è®¾è®¡è§„èŒƒã€‚

---

## 1. äº§å“æ¦‚è¿°

### 1.1 äº§å“å®šä½

**Curve** æ˜¯ä¸€ä¸ªé¢å‘ç§‘ç ”äººå‘˜çš„ AI å¯¹è¯å¹³å°ï¼Œä¸“æ³¨äºè¯ç‰©åˆ†å­ç ”å‘è¾…åŠ©ã€ç§‘ç ”æ–‡çŒ®æ£€ç´¢ä¸åˆ†æã€æ•°æ®åˆ†æä¸å¯è§†åŒ–ç­‰åœºæ™¯ã€‚

### 1.2 ç›®æ ‡ç”¨æˆ·

- è¯ç‰©ç ”å‘ç§‘å­¦å®¶
- åŒ–å­¦/ç”Ÿç‰©ä¿¡æ¯å­¦ç ”ç©¶å‘˜
- æ•°æ®ç§‘å­¦å®¶
- ç§‘ç ”é¡¹ç›®ç®¡ç†äººå‘˜

### 1.3 æ ¸å¿ƒä»·å€¼

| èƒ½åŠ› | æè¿° |
|------|------|
| å¤š Agent åä½œ | æ”¯æŒ Xtalpi Agentã€Research Agentã€Data Agentã€Code Agent ç­‰å¤šç§ä¸“ä¸š Agent |
| åˆ†æ”¯å¯¹è¯ | ä»ä»»æ„æ¶ˆæ¯åˆ›å»ºåˆ†æ”¯ï¼Œæ”¯æŒå¤šè·¯å¾„æ¢ç´¢ä¸ç»“è®ºåˆå¹¶ |
| æ™ºèƒ½å½’æ¡£ | è‡ªåŠ¨æå–å¯¹è¯ä¸­çš„è¡¨æ ¼ã€å›¾ç‰‡ã€åˆ†å­æ•°æ®å¹¶å½’æ¡£ |
| æŠ€èƒ½æ¨¡ç‰ˆ | å¯å¤ç”¨çš„ Prompt æ¨¡ç‰ˆï¼Œæå‡ç§‘ç ”æ•ˆç‡ |
| åˆ†å­æ•°æ®å¤„ç† | SMILES è§£æã€åˆ†å­å±æ€§è®¡ç®—ã€ç»“æ„å¯è§†åŒ– |

---

## 2. ç³»ç»Ÿæ¶æ„

### 2.1 æŠ€æœ¯æ ˆ

```
å‰ç«¯æ¡†æ¶:     React 18 + TypeScript
æ„å»ºå·¥å…·:     Vite
æ ·å¼æ–¹æ¡ˆ:     TailwindCSS + CSS Variables
çŠ¶æ€ç®¡ç†:     React Query + Context API
UI ç»„ä»¶åº“:    shadcn/ui (Radix UI åŸºç¡€)
åç«¯æœåŠ¡:     Supabase (PostgreSQL + Edge Functions)
å®æ—¶é€šä¿¡:     Supabase Realtime (WebSocket)
```

### 2.2 é¡µé¢è·¯ç”±

```
/                 â†’ Index (é¡¹ç›®ä¸»é¡µ + å¯¹è¯åŒºåŸŸ)
/agent            â†’ Agent (Agent ç®¡ç†é¡µ)
/workflow         â†’ Workflow (å·¥ä½œæµé¡µé¢)
/skills-hub       â†’ Skills Hub (æŠ€èƒ½æ¨¡ç‰ˆç®¡ç†)
*                 â†’ 404 NotFound
```

### 2.3 å…¨å±€çŠ¶æ€ç®¡ç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NavigationContext                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ breadcrumbItems       - é¢åŒ…å±‘å¯¼èˆªé¡¹                       â”‚
â”‚ â€¢ isBranchTreeView      - æ˜¯å¦åœ¨åˆ†æ”¯æ ‘è§†å›¾                    â”‚
â”‚ â€¢ isFolderOpen          - æ™ºèƒ½æ–‡ä»¶å¤¹å¼€å¯çŠ¶æ€                   â”‚
â”‚ â€¢ folderBranchId        - å½“å‰æŸ¥çœ‹çš„åˆ†æ”¯ ID                   â”‚
â”‚ â€¢ contentWidth          - å†…å®¹åŒºåŸŸå®½åº¦ï¼ˆå“åº”å¼ï¼‰               â”‚
â”‚ â€¢ pendingSkillInjection - å¾…æ³¨å…¥çš„æŠ€èƒ½å†…å®¹                    â”‚
â”‚ â€¢ onSendToAgent         - å…¨å±€å‘é€æ¶ˆæ¯å›è°ƒ                    â”‚
â”‚ â€¢ onNavigateToMessage   - è·³è½¬æ¶ˆæ¯å›è°ƒ                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4 Provider å±‚çº§

```tsx
<QueryClientProvider>          // React Query ç¼“å­˜
  <TooltipProvider>            // å…¨å±€ Tooltip
    <NavigationProvider>       // å¯¼èˆªçŠ¶æ€
      <Toaster />              // Toast é€šçŸ¥
      <BrowserRouter>          // è·¯ç”±
        <MainLayout>           // ä¸»å¸ƒå±€
          <Outlet />           // é¡µé¢å†…å®¹
        </MainLayout>
      </BrowserRouter>
    </NavigationProvider>
  </TooltipProvider>
</QueryClientProvider>
```

---

## 3. åŠŸèƒ½æ¨¡å—è¯¦è§£

### 3.1 ä¾§è¾¹æ æ¨¡å— (Sidebar)

#### å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Logo] Curve     [æ”¶èµ·æŒ‰é’®]  â”‚  â† å“ç‰ŒåŒºåŸŸ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [+] æ–°å»ºé¡¹ç›®                 â”‚  â† æ“ä½œåŒºåŸŸ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ æ‰€æœ‰é¡¹ç›®       [åˆ·æ–°]     â”‚  â† åˆ†ç»„æ ‡é¢˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”¬ åˆ†å­ç»“æ„åˆ†æå®éªŒ          â”‚
â”‚  ğŸ“Š æ•°æ®å¯è§†åŒ–é¡¹ç›®            â”‚  â† é¡¹ç›®åˆ—è¡¨ï¼ˆå¯æ»šåŠ¨ï¼‰
â”‚  ğŸ’Š è¯ç‰©é¶ç‚¹ç ”ç©¶              â”‚
â”‚  ...                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [èƒ½åŠ›çŸ©é˜µ] [ç”¨æˆ·ä¸­å¿ƒ]         â”‚  â† åº•éƒ¨å·¥å…·æ 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### äº¤äº’é€»è¾‘

| æ“ä½œ | è¡Œä¸º |
|------|------|
| ç‚¹å‡»é¡¹ç›® | åˆ‡æ¢å½“å‰æ´»è·ƒé¡¹ç›®ï¼ŒåŠ è½½å¯¹åº”æ¶ˆæ¯ |
| å³é”®é¡¹ç›® | æ˜¾ç¤ºä¸Šä¸‹æ–‡èœå•ï¼ˆé‡å‘½å/åˆ é™¤/å¤åˆ¶/å¯¼å‡º/åˆ†äº«ï¼‰ |
| ç‚¹å‡»æ–°å»ºé¡¹ç›® | æ‰“å¼€ `NewProjectDialog` |
| ç‚¹å‡»æ”¶èµ·æŒ‰é’® | ä¾§è¾¹æ æŠ˜å ä¸ºå›¾æ ‡æ¨¡å¼ (52px) |
| ç‚¹å‡»èƒ½åŠ›çŸ©é˜µ | å¼¹å‡º `CapabilitiesMenu`ï¼ˆAgent/Workflow/Skills Hubï¼‰ |
| ç‚¹å‡»ç”¨æˆ·ä¸­å¿ƒ | å¼¹å‡ºç”¨æˆ·èœå•ï¼ˆè®¾ç½®/æ—¥å¿—/è¯­è¨€/é€€å‡ºï¼‰ |

#### æŠ˜å çŠ¶æ€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [å±•å¼€] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [+]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”¬    â”‚
â”‚  ğŸ“Š    â”‚
â”‚  ğŸ’Š    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [èƒ½åŠ›] â”‚
â”‚ [ç”¨æˆ·] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
å®½åº¦: 52px
```

#### ç»„ä»¶ä¾èµ–

```
Sidebar
â”œâ”€â”€ CurveLogo
â”œâ”€â”€ ProjectItem
â”‚   â””â”€â”€ ContextMenu (å³é”®èœå•)
â”œâ”€â”€ NewProjectDialog
â”‚   â”œâ”€â”€ IconPicker
â”‚   â””â”€â”€ AgentAvatar
â”œâ”€â”€ DeleteConfirmDialog
â”œâ”€â”€ RenameDialog
â”œâ”€â”€ CapabilitiesMenu
â””â”€â”€ UserMenu (Portal)
```

---

### 3.2 é¡¶éƒ¨å¯¼èˆªæ  (TopNavbar)

#### å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [â† åˆ†æ”¯è§†å›¾]                    [æœç´¢] [æ–‡ä»¶å¤¹] [é‚€è¯·] [åˆ†äº«]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å·¦ä¾§åŠ¨æ€æŒ‰é’®

| å½“å‰çŠ¶æ€ | æ˜¾ç¤ºå†…å®¹ | ç‚¹å‡»è¡Œä¸º |
|----------|----------|----------|
| å¯¹è¯é¡µé¢ | â† åˆ†æ”¯è§†å›¾ | è¿›å…¥ BranchTreeView |
| åˆ†æ”¯æ ‘è§†å›¾ | â† è¿”å›å¯¹è¯ | è¿”å›å¯¹è¯é¡µé¢ |
| Agent/Workflow é¡µé¢ | â† è¿”å›é¡¹ç›® | å¯¼èˆªåˆ°é¦–é¡µ |

#### å³ä¾§æ“ä½œæŒ‰é’®

| æŒ‰é’® | åŠŸèƒ½ | çŠ¶æ€æŒ‡ç¤º |
|------|------|----------|
| æœç´¢ | æ‰“å¼€ GlobalSearchPalette | æ¿€æ´»æ—¶é«˜äº® |
| æ–‡ä»¶å¤¹ | åˆ‡æ¢ SmartFolderPanel | æœ‰æ–°å†…å®¹æ—¶æ˜¾ç¤ºè„‰å†²åŠ¨ç”» |
| é‚€è¯· | æ‰“å¼€é‚€è¯·åä½œè€…å¯¹è¯æ¡† | - |
| åˆ†äº« | å¤åˆ¶å½“å‰é¡µé¢é“¾æ¥ | - |

#### æŒ‰é’®äº¤äº’æ ·å¼

```css
/* é»˜è®¤çŠ¶æ€ */
color: #52525b;
background: transparent;

/* Hover çŠ¶æ€ */
color: #123aff;
background: rgba(18, 58, 255, 0.08);

/* æ¿€æ´»çŠ¶æ€ */
color: #123aff;
background: rgba(18, 58, 255, 0.08);
```

---

### 3.3 å¯¹è¯åŒºåŸŸ (ChatArea)

#### å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ç”¨æˆ·æ¶ˆæ¯                                         [ç¼–è¾‘][åˆ†æ”¯] â”‚ â”‚
â”‚  â”‚ "è¯·åˆ†æä»¥ä¸‹ SMILES çš„åˆ†å­æ€§è´¨..."                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [Agent å¤´åƒ]                                                  â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ <reasoning> æ¨ç†è¿‡ç¨‹...                               â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ <tools> è°ƒç”¨å·¥å…·...                                   â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â”‚ <conclusion> ç»“è®º...                                  â”‚   â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚ [åˆ†æ”¯] [ä¿å­˜æŠ€èƒ½]                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [+] [åˆ†å­ç¼–è¾‘å™¨]           [Agenté€‰æ‹©] [å‘é€]               â”‚ â”‚
â”‚  â”‚ å‘é€æ¶ˆæ¯ç»™ Curve...                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ¶ˆæ¯ç»„ä»¶

**ç”¨æˆ·æ¶ˆæ¯ (UserMessage)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [æ“ä½œæŒ‰é’®]              [æ¶ˆæ¯å†…å®¹æ°”æ³¡]              [ç”¨æˆ·å¤´åƒ] â”‚
â”‚                                                                â”‚
â”‚ [ç¼–è¾‘][å¤åˆ¶][åˆ†æ”¯]      "è¯·åˆ†æä»¥ä¸‹åˆ†å­..."        [ğŸ‘¤]        â”‚
â”‚                         â””â”€ èƒŒæ™¯: primary (è“è‰²)                â”‚
â”‚                         â””â”€ åœ†è§’: rounded-2xl rounded-tr-md    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Agent æ¶ˆæ¯ (AgentMessage)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Agent å¤´åƒ]           [ç»“æ„åŒ–æ¶ˆæ¯å†…å®¹]                        â”‚
â”‚                                                                â”‚
â”‚ [ğŸ¤–]                   â”Œâ”€ Reasoning åŒºå— (å¯æŠ˜å )             â”‚
â”‚                        â”œâ”€ Tools åŒºå— (å¯æŠ˜å )                  â”‚
â”‚                        â”œâ”€ Conclusion åŒºå—                      â”‚
â”‚                        â”œâ”€ æ™®é€šå†…å®¹ (Markdown æ¸²æŸ“)              â”‚
â”‚                        â””â”€ åˆ†å­æ•°æ®è¡¨æ ¼/å›¾è¡¨                     â”‚
â”‚                                                                â”‚
â”‚                        [åˆ†æ”¯] [ä¿å­˜ä¸ºæŠ€èƒ½]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç»“æ„åŒ–æ¶ˆæ¯è§£æ

Agent å›å¤æ”¯æŒä»¥ä¸‹ XML æ ‡ç­¾çš„è‡ªåŠ¨è§£æä¸æ¸²æŸ“ï¼š

```xml
<reasoning>...</reasoning>   â†’ æ¨ç†è¿‡ç¨‹ï¼ˆå¯æŠ˜å ï¼Œç°è‰²èƒŒæ™¯ï¼‰
<tools>...</tools>           â†’ å·¥å…·è°ƒç”¨ï¼ˆå¯æŠ˜å ï¼Œç°è‰²èƒŒæ™¯ï¼‰
<conclusion>...</conclusion> â†’ ç»“è®ºï¼ˆé«˜äº®æ˜¾ç¤ºï¼‰
<molecule-data>...</molecule-data> â†’ åˆ†å­æ•°æ®è¡¨æ ¼
```

#### è¾“å…¥æ¡† (ChatInput)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [æ–‡ä»¶é¢„è§ˆå¡ç‰‡åŒºåŸŸ]                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å‘é€æ¶ˆæ¯ç»™ Curve...                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [+ä¸Šä¼ ] [åˆ†å­ç¼–è¾‘å™¨]              [Agenté€‰æ‹©â–¼] [å‘é€â†’]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| åŠŸèƒ½ | æè¿° |
|------|------|
| æ–‡ä»¶ä¸Šä¼  | æ‹–æ‹½æˆ–ç‚¹å‡»ä¸Šä¼ ï¼Œæ”¯æŒå›¾ç‰‡/æ–‡æ¡£é¢„è§ˆ |
| åˆ†å­ç¼–è¾‘å™¨ | æ‰“å¼€ MoleculeEditorDialog ç»˜åˆ¶åˆ†å­ç»“æ„ |
| Agent é€‰æ‹©å™¨ | ä¸‹æ‹‰åˆ‡æ¢å½“å‰ Agent |
| å‘é€æŒ‰é’® | Enter å‘é€ï¼ŒShift+Enter æ¢è¡Œ |

#### æ¶ˆæ¯æµè½¬æœºåˆ¶

```
ç”¨æˆ·è¾“å…¥
    â†“
handleSend()
    â”œâ”€â†’ ä¹è§‚æ›´æ–° localMessages
    â”œâ”€â†’ æ’å…¥ Supabase messages è¡¨
    â””â”€â†’ è°ƒç”¨ Edge Function (streaming)
           â†“
    SSE æµå¼å“åº”
        â†“
    upsertAssistant()
        â”œâ”€â†’ å®æ—¶æ›´æ–° UI (isStreaming: true)
        â””â”€â†’ å®Œæˆåä¿å­˜åˆ°æ•°æ®åº“
               â†“
    parseMessageContent()
        â”œâ”€â†’ æå– <reasoning> / <tools> / <conclusion>
        â”œâ”€â†’ æå–æ–‡ä»¶é™„ä»¶
        â””â”€â†’ æ£€æµ‹åˆ†å­æ•°æ®
               â†“
    archiveContent()
        â””â”€â†’ è‡ªåŠ¨å½’æ¡£è¡¨æ ¼/å›¾ç‰‡åˆ° SmartFolder
```

#### é¡¹ç›®éš”ç¦»æœºåˆ¶

```typescript
// 1. API è¯·æ±‚æ—¶ç»‘å®š project_id
const { data } = await supabase
  .from("messages")
  .select("*")
  .eq("project_id", projectId);

// 2. å‰ç«¯äºŒæ¬¡è¿‡æ»¤
const validMessages = data.filter(m => m.project_id === projectId);

// 3. å®æ—¶è®¢é˜…æ—¶è¿‡æ»¤
.on("postgres_changes", {
  filter: `project_id=eq.${projectId}`
})

// 4. æ¸²æŸ“å‰éªŒè¯
if (currentProjectIdRef.current !== projectId) return;
```

---

### 3.4 åˆ†æ”¯ç®¡ç†ç³»ç»Ÿ (BranchTreeView)

#### è§†è§‰å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [N ä¸ªä¼šè¯åˆ†æ”¯]                       [ç¼©å°] [85%] [æ”¾å¤§] [é‡ç½®] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                â”‚
â”‚   â”‚   ä¸»çº¿      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚   â”‚ [æ ¸å¿ƒç»“è®º]  â”‚        â”‚                                       â”‚
â”‚   â”‚ [å…³é”®é—®é¢˜]  â”‚        â–¼                                       â”‚
â”‚   â”‚             â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚   â”‚ æ—¶é—´ | æ¶ˆæ¯ â”‚   â”‚  åˆ†æ”¯ A     â”‚                              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ [æ ¸å¿ƒç»“è®º]  â”‚                              â”‚
â”‚                      â”‚ [å…³é”®é—®é¢˜]  â”‚                              â”‚
â”‚                      â”‚             â”‚                              â”‚
â”‚                      â”‚ æ—¶é—´ | æ¶ˆæ¯ â”‚                              â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                  â”‚
â”‚                    åŒå‡»å¡ç‰‡è¿›å…¥å¯¹è¯ Â· æ‹–æ‹½ç”»å¸ƒç§»åŠ¨ Â· Ctrl+æ»šè½®ç¼©æ”¾â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### åˆ†æ”¯å¡ç‰‡ (BranchCard)

**å°ºå¯¸**: 360px Ã— 280px  
**é—´è·**: æ°´å¹³ 160pxï¼Œå‚ç›´ 80px

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [å›¾æ ‡] åˆ†æ”¯åç§°                           [æ–‡ä»¶å¤¹] [æ›´å¤šâ–¼]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  æ ¸å¿ƒç»“è®º                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚
â”‚  è¿™æ˜¯è¯¥åˆ†æ”¯çš„æ ¸å¿ƒå‘ç°æ€»ç»“...                                  â”‚
â”‚                                                              â”‚
â”‚  å…³é”®é—®é¢˜                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚
â”‚  [é—®é¢˜1] [é—®é¢˜2] [é—®é¢˜3]                                     â”‚
â”‚                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ• 1æœˆ8æ—¥ 14:30         ğŸ’¬ 12 æ¡æ¶ˆæ¯        [3 ä¸ªåˆ†æ”¯]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                           [+] â† æ‚¬æµ®åˆ›å»ºåˆ†æ”¯
```

#### å¡ç‰‡çŠ¶æ€

| çŠ¶æ€ | æ ·å¼ |
|------|------|
| é»˜è®¤ | `bg-card/60 border-border/40` |
| æ‚¬æµ® | `-translate-y-3 shadow-2xl` |
| é€‰ä¸­ | `border-2 border-primary/40 ring-2 ring-primary` |
| ä¸»åˆ†æ”¯ | å›¾æ ‡ä½¿ç”¨ Sparkles æ›¿ä»£ GitBranch |

#### è¿æ¥çº¿åŠ¨ç”»

```svg
<!-- ä¸»åˆ†æ”¯è¿æ¥çº¿ï¼šæµåŠ¨åŠ¨ç”» -->
<linearGradient id="mainConnectionGradient">
  <stop offset="0%" stopColor="#123aff" stopOpacity="0.8" />
  <stop offset="100%" stopColor="#123aff" stopOpacity="0.4" />
</linearGradient>

<!-- æ™®é€šåˆ†æ”¯è¿æ¥çº¿ï¼šé™æ€æ¸å˜ -->
<linearGradient id="normalConnectionGradient">
  <stop offset="0%" stopColor="hsl(var(--muted-foreground))" stopOpacity="0.4" />
  <stop offset="100%" stopColor="hsl(var(--border))" stopOpacity="0.3" />
</linearGradient>
```

#### ç”»å¸ƒäº¤äº’

| æ“ä½œ | è¡Œä¸º |
|------|------|
| æ‹–æ‹½ç©ºç™½åŒºåŸŸ | å¹³ç§»ç”»å¸ƒ |
| Ctrl + æ»šè½® | ç¼©æ”¾ (0.3x ~ 2x) |
| åŒå‡»å¡ç‰‡ | è¿›å…¥è¯¥åˆ†æ”¯å¯¹è¯ |
| ç‚¹å‡» [+] æŒ‰é’® | åˆ›å»ºå­åˆ†æ”¯ |
| ç‚¹å‡»æ–‡ä»¶å¤¹å›¾æ ‡ | æ‰“å¼€è¯¥åˆ†æ”¯çš„ SmartFolder |
| ç‚¹å‡»æ›´å¤šèœå• | é‡å‘½å/å¤åˆ¶/åˆ é™¤ |

---

### 3.5 æ™ºèƒ½æ–‡ä»¶å¤¹ (SmartFolderPanel)

#### å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š æ™ºèƒ½æ–‡ä»¶å¤¹ - åˆ†æ”¯åç§°                          [Ã—]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  ğŸ“Š å¯¹æ¯”è¡¨æ ¼ (2)                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ åˆ†å­æ€§è´¨å¯¹æ¯”è¡¨                    [è·³è½¬] [ä¸‹è½½]     â”‚â”‚
â”‚  â”‚ 1æœˆ8æ—¥ 14:30 Â· 5 è¡Œ                                 â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚  â”‚ â”‚ ID | SMILES | MW | LogP | ...                 â”‚  â”‚â”‚
â”‚  â”‚ â”‚ ...                                           â”‚  â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                          â”‚
â”‚  ğŸ–¼ï¸ ç»“æ„å›¾è¡¨ (3)                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ [åˆ†å­ç»“æ„] â”‚ â”‚ [åˆ†å­ç»“æ„] â”‚ â”‚ [å›¾è¡¨]     â”‚          â”‚
â”‚  â”‚ å¸ƒæ´›èŠ¬     â”‚ â”‚ æ‰‘çƒ­æ¯ç—›   â”‚ â”‚ åˆ†å¸ƒå›¾     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å½’æ¡£å†…å®¹ç±»å‹

| ç±»å‹ | è¯†åˆ«è§„åˆ™ | å­˜å‚¨æ ¼å¼ |
|------|----------|----------|
| è¡¨æ ¼ | `<molecule-data>` æ ‡ç­¾ã€Markdown è¡¨æ ¼ã€CSV ä»£ç å— | ArchivedTable |
| åˆ†å­å›¾ | SMILES â†’ PubChem API ç”Ÿæˆ | ArchivedImage (type: structure) |
| å›¾è¡¨ | æ£€æµ‹åˆ° JSON å›¾è¡¨æ•°æ® | ArchivedImage (type: chart) |
| å›¾ç‰‡ | URL / Base64 å›¾ç‰‡ | ArchivedImage (type: other) |

#### å®½åº¦è°ƒèŠ‚

```
æœ€å°å®½åº¦: 300px
æœ€å¤§å®½åº¦: 60% è§†å£å®½åº¦
é»˜è®¤å®½åº¦: 400px

æ‹–æ‹½åˆ†éš”æ¡å¯è°ƒèŠ‚å®½åº¦ï¼Œå·¦ä¾§å†…å®¹åŒºæœ€å°ä¿æŒ 400px
```

---

### 3.6 Skills Hub

#### è§†å›¾æ¨¡å¼

**ç½‘æ ¼è§†å›¾ (Grid View)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Skills Hub                                          [+ æ–°å»ºæŠ€èƒ½] â”‚
â”‚ ç§‘ç ”æŠ€èƒ½çš„é›†ä¸­ç®¡ç†ä¸æŒ‡ä»¤ç¼–æ’                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ [å›¾æ ‡]       â”‚  â”‚ [å›¾æ ‡]       â”‚  â”‚ [å›¾æ ‡]       â”‚           â”‚
â”‚  â”‚ æ–‡çŒ®ç»¼è¿°åŠ©æ‰‹  â”‚  â”‚ åˆ†å­æ€§è´¨é€ŸæŸ¥  â”‚  â”‚ ç²¾å‡†æ£€ç´¢     â”‚           â”‚
â”‚  â”‚ æè¿°æ–‡å­—...  â”‚  â”‚ æè¿°æ–‡å­—...  â”‚  â”‚ æè¿°æ–‡å­—...  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¼–è¾‘è§†å›¾ (Edit View) - ä¸‰æ å¸ƒå±€**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [â† è¿”å›æ€»è§ˆ] â”‚ æ–‡çŒ®ç»¼è¿°åŠ©æ‰‹ - æ·±åº¦é…ç½®æ¨¡å¼                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚                                       â”‚           â”‚
â”‚ [æŠ€èƒ½åˆ—è¡¨]   â”‚        [æŒ‡ä»¤æ¨¡ç‰ˆç¼–è¾‘åŒº]                â”‚ [é…ç½®é¢æ¿]â”‚
â”‚              â”‚                                       â”‚           â”‚
â”‚ â—‹ æ–‡çŒ®ç»¼è¿°   â”‚  è¯·å›´ç»•ä»¥ä¸‹ç ”ç©¶ä¸»é¢˜è¿›è¡Œç³»ç»Ÿç»¼è¿°...     â”‚ ç»‘å®š Agentâ”‚
â”‚ â— åˆ†å­é€ŸæŸ¥   â”‚  - ä¸»é¢˜ï¼š{{ç ”ç©¶ä¸»é¢˜}}                 â”‚ [é€‰æ‹©â–¼]   â”‚
â”‚ â—‹ ç²¾å‡†æ£€ç´¢   â”‚  - ç›®æ ‡æœŸåˆŠï¼š{{ç›®æ ‡æœŸåˆŠ}}             â”‚           â”‚
â”‚ â—‹ æ™ºèƒ½ç¼–æ’   â”‚  ...                                  â”‚ å˜é‡æç¤º  â”‚
â”‚              â”‚                                       â”‚ è¾“å‡ºæ ¡éªŒ  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                            [å–æ¶ˆ] [ä¿å­˜]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æŠ€èƒ½æ•°æ®ç»“æ„

```typescript
interface Skill {
  id: string;
  name: string;
  description: string;
  icon: LucideIcon;
  content: string;           // Prompt æ¨¡ç‰ˆå†…å®¹
  targetAgentId?: string;    // ç»‘å®šçš„ Agent ID
}
```

#### æŠ€èƒ½æ³¨å…¥æµç¨‹

```
ç”¨æˆ·åœ¨ Skills Hub ç‚¹å‡»"ä½¿ç”¨æŠ€èƒ½"
    â†“
injectSkill({ content, targetAgentId, skillName })
    â†“
NavigationContext.pendingSkillInjection æ›´æ–°
    â†“
ChatArea ç›‘å¬åˆ° pendingSkillInjection
    â”œâ”€â†’ è‡ªåŠ¨åˆ‡æ¢åˆ° targetAgentId
    â”œâ”€â†’ å¡«å…… content åˆ° ChatInput
    â””â”€â†’ å®šä½åˆ°ç¬¬ä¸€ä¸ª {{å˜é‡}} å ä½ç¬¦
```

---

### 3.7 å…¨å±€æœç´¢ (GlobalSearchPalette)

#### å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” æœç´¢é¡¹ç›®æˆ–å‘ AI æé—®...                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  é¡¹ç›®                                                    â”‚
â”‚  â”€â”€â”€â”€                                                    â”‚
â”‚  ğŸ”¬ åˆ†å­ç»“æ„åˆ†æå®éªŒ                              â†’     â”‚
â”‚  ğŸ“Š æ•°æ®å¯è§†åŒ–é¡¹ç›®                                â†’     â”‚
â”‚                                                          â”‚
â”‚  AI æé—®                                                 â”‚
â”‚  â”€â”€â”€â”€                                                    â”‚
â”‚  ğŸ¤– å‘ AI æé—®: [ç”¨æˆ·è¾“å…¥å†…å®¹]                    â†’     â”‚
â”‚     æŒ‰ Enter å‘é€                                        â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æœç´¢é€»è¾‘

```typescript
// é¡¹ç›®æœç´¢
const filteredProjects = projects.filter(
  (project) =>
    project.name.toLowerCase().includes(query) ||
    project.author.toLowerCase().includes(query)
);

// æ— ç»“æœæ—¶æ˜¾ç¤º AI æé—®é€‰é¡¹
if (!hasResults && query.trim()) {
  // æ˜¾ç¤º "å‘ AI æé—®" é€‰é¡¹
}
```

#### æ“ä½œè¡Œä¸º

| é€‰æ‹©é¡¹ | è¡Œä¸º |
|--------|------|
| é€‰æ‹©é¡¹ç›® | åˆ‡æ¢åˆ°è¯¥é¡¹ç›®ï¼Œå¯¼èˆªåˆ°é¦–é¡µ |
| é€‰æ‹© AI æé—® | å¯¼èˆªåˆ°é¦–é¡µï¼Œè°ƒç”¨ onSendToAgent å‘é€æ¶ˆæ¯ |

---

## 4. äº¤äº’è®¾è®¡è§„èŒƒ

### 4.1 é¡µé¢å¯¼èˆªé€»è¾‘

```
é¦–é¡µ (/)
    â”œâ”€â”€ [ä¾§è¾¹æ ] ç‚¹å‡»é¡¹ç›® â†’ åˆ‡æ¢é¡¹ç›®ï¼Œä¿æŒé¦–é¡µ
    â”œâ”€â”€ [é¡¶éƒ¨å¯¼èˆª] åˆ†æ”¯è§†å›¾ â†’ è¿›å…¥ BranchTreeView
    â”œâ”€â”€ [èƒ½åŠ›çŸ©é˜µ] Agent â†’ /agent
    â”œâ”€â”€ [èƒ½åŠ›çŸ©é˜µ] Workflow â†’ /workflow
    â””â”€â”€ [èƒ½åŠ›çŸ©é˜µ] Skills Hub â†’ /skills-hub

BranchTreeView
    â”œâ”€â”€ [é¡¶éƒ¨å¯¼èˆª] è¿”å›å¯¹è¯ â†’ é€€å‡ºåˆ†æ”¯è§†å›¾
    â”œâ”€â”€ åŒå‡»å¡ç‰‡ â†’ åˆ‡æ¢åˆ†æ”¯å¹¶è¿”å›å¯¹è¯
    â””â”€â”€ [å¡ç‰‡æ–‡ä»¶å¤¹] â†’ æ‰“å¼€ SmartFolderPanel

Agent/Workflow/Skills Hub
    â””â”€â”€ [é¡¶éƒ¨å¯¼èˆª] è¿”å›é¡¹ç›® â†’ å¯¼èˆªåˆ°é¦–é¡µ
```

### 4.2 çŠ¶æ€ä¿æŒè§„åˆ™

| åœºæ™¯ | ä¿æŒçŠ¶æ€ | é‡ç½®çŠ¶æ€ |
|------|----------|----------|
| åˆ‡æ¢é¡¹ç›® | - | Agent é€‰æ‹©ã€åˆ†æ”¯çŠ¶æ€ã€æœ¬åœ°æ¶ˆæ¯ã€æ–‡ä»¶å¤¹çŠ¶æ€ |
| åˆ‡æ¢åˆ†æ”¯ | é¡¹ç›®ä¸Šä¸‹æ–‡ | æ¶ˆæ¯è¿‡æ»¤æ¡ä»¶ |
| è¿›å…¥åˆ†æ”¯è§†å›¾ | å½“å‰é¡¹ç›®ã€å½“å‰åˆ†æ”¯ | - |
| é¡µé¢åˆ·æ–° | - | æ‰€æœ‰ä¸´æ—¶çŠ¶æ€ |

### 4.3 æµå¼å“åº”å¤„ç†

```
å¼€å§‹å“åº”
    â†“
åˆ›å»ºç©º assistant æ¶ˆæ¯ (isStreaming: true)
    â†“
æ˜¾ç¤º ThinkingLoader
    â†“
æ¥æ”¶ SSE æ•°æ®å—
    â†“
ç´¯ç§¯æ›´æ–°æ¶ˆæ¯å†…å®¹
    â†“
å®Œæˆå“åº”
    â”œâ”€â†’ è®¾ç½® isStreaming: false
    â”œâ”€â†’ ä¿å­˜åˆ°æ•°æ®åº“
    â””â”€â†’ è§¦å‘å½’æ¡£æ£€æµ‹
```

### 4.4 è¶…æ—¶ä¸é”™è¯¯å¤„ç†

| æƒ…å†µ | è¶…æ—¶æ—¶é—´ | å¤„ç†æ–¹å¼ |
|------|----------|----------|
| æµå¼å“åº” | 60ç§’ | æ¸…ç† streaming æ¶ˆæ¯ï¼Œæ˜¾ç¤ºè¶…æ—¶æç¤º |
| é¡¹ç›®åˆ‡æ¢ | ç«‹å³ | ä¸­æ­¢å½“å‰è¯·æ±‚ (AbortController) |
| ç½‘ç»œé”™è¯¯ | - | æ˜¾ç¤ºé”™è¯¯æç¤ºï¼Œç§»é™¤æœªå®Œæˆæ¶ˆæ¯ |

---

## 5. UI è®¾è®¡è§„èŒƒ

### 5.1 è‰²å½©ä½“ç³»

#### ä¸»è‰² (XtalPi å“ç‰Œè‰²)

```css
/* ä¸»è“è‰² */
--xtalpi-blue: #123aff;
--xtalpi-blue-dark: #1609a0;
--xtalpi-cyan: #00ffff;

/* ä¸»ç»¿è‰² */
--xtalpi-green: #00ff9a;
--xtalpi-green-dark: #00a29c;
--xtalpi-teal: #00ffd4;
```

#### æ¸å˜è‰²

```css
/* è“è‰²æ¸å˜ */
.gradient-xtalpi-blue {
  background: linear-gradient(90deg, #1609a0, #00ffff);
}

/* ç»¿è‰²æ¸å˜ */
.gradient-xtalpi-green {
  background: linear-gradient(90deg, #00a29c, #00ffd4);
}
```

#### è¯­ä¹‰è‰²

```css
/* èƒŒæ™¯è‰² */
--background: 210 20% 98%;     /* #f8fafc */
--card: 0 0% 100%;             /* #ffffff */
--muted: 214 20% 94%;          /* #eff1f5 */

/* å‰æ™¯è‰² */
--foreground: 222 47% 11%;     /* #1e293b */
--muted-foreground: 220 13% 46%; /* #64748b */

/* è¾¹æ¡† */
--border: 214 32% 91%;         /* #e2e8f0 */

/* äº¤äº’æ€ */
--primary: 228 100% 54%;       /* #123aff */
--hover-bg: rgba(18, 58, 255, 0.08);
```

### 5.2 å­—ä½“è§„èŒƒ

```css
font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
```

| åœºæ™¯ | å­—å· | å­—é‡ | è¡Œé«˜ |
|------|------|------|------|
| é¡µé¢æ ‡é¢˜ | 20px (text-xl) | 600 (font-semibold) | 1.75rem |
| åŒºå—æ ‡é¢˜ | 14px (text-sm) | 600 (font-semibold) | 1.25rem |
| æ­£æ–‡å†…å®¹ | 14px (text-sm) | 400 (font-normal) | 1.5rem |
| è¾…åŠ©æ–‡å­— | 12px (text-xs) | 400 (font-normal) | 1rem |
| æŒ‰é’®æ–‡å­— | 14px (text-sm) | 500 (font-medium) | - |

### 5.3 é—´è·è§„èŒƒ

```css
/* åŸºç¡€é—´è· */
--spacing-1: 0.25rem;   /* 4px */
--spacing-2: 0.5rem;    /* 8px */
--spacing-3: 0.75rem;   /* 12px */
--spacing-4: 1rem;      /* 16px */
--spacing-6: 1.5rem;    /* 24px */
--spacing-8: 2rem;      /* 32px */

/* å¸¸ç”¨åœºæ™¯ */
å¡ç‰‡å†…è¾¹è·: 16px (p-4)
åˆ—è¡¨é¡¹é—´è·: 8px (gap-2)
åŒºå—é—´è·: 24px (space-y-6)
é¡µé¢è¾¹è·: 24px (px-6)
```

### 5.4 åœ†è§’è§„èŒƒ

```css
--radius: 0.75rem;  /* 12px - åŸºç¡€åœ†è§’ */

/* åœºæ™¯åº”ç”¨ */
æŒ‰é’®: rounded-lg (8px)
å¡ç‰‡: rounded-xl (12px)
æ°”æ³¡: rounded-2xl (16px)
å¤´åƒ: rounded-full
è¾“å…¥æ¡†: rounded-lg (8px)
å¯¹è¯æ¡†: rounded-xl (12px)
```

### 5.5 é˜´å½±è§„èŒƒ

```css
/* å¡ç‰‡é˜´å½± */
shadow-card: 0 1px 3px rgba(0, 0, 0, 0.05);
shadow-card-hover: 0 4px 6px rgba(0, 0, 0, 0.1);

/* è¾“å…¥æ¡†é˜´å½± */
shadow-input: 0 2px 8px rgba(0, 0, 0, 0.08);

/* å‘å…‰æ•ˆæœ */
shadow-glow-blue: 0 0 20px rgba(18, 58, 255, 0.3);
shadow-glow-green: 0 0 20px rgba(0, 255, 154, 0.3);
```

### 5.6 åŠ¨æ•ˆè§„èŒƒ

```css
/* è¿‡æ¸¡æ—¶é—´ */
transition-fast: 150ms
transition-normal: 200ms
transition-slow: 300ms

/* ç¼“åŠ¨å‡½æ•° */
ease-out: cubic-bezier(0, 0, 0.2, 1)
ease-in-out: cubic-bezier(0.4, 0, 0.2, 1)

/* å¸¸ç”¨åŠ¨ç”» */
@keyframes fade-in {
  from { opacity: 0; transform: translateY(4px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 5px rgba(18, 58, 255, 0.3); }
  50% { box-shadow: 0 0 20px rgba(18, 58, 255, 0.5); }
}

@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}
```

### 5.7 æŒ‰é’®æ ·å¼

#### ä¸»æŒ‰é’®

```css
background: #123aff;
color: white;
border-radius: 8px;
padding: 0 16px;
height: 36px;

/* Hover */
background: rgba(18, 58, 255, 0.9);

/* Disabled */
background: #e2e8f0;
color: #94a3b8;
cursor: not-allowed;
```

#### æ¬¡è¦æŒ‰é’®

```css
background: white;
color: #475569;
border: 1px solid #e2e8f0;
border-radius: 8px;

/* Hover */
background: #f8fafc;
border-color: #cbd5e1;
```

#### å¹½çµæŒ‰é’® (å›¾æ ‡æŒ‰é’®)

```css
background: transparent;
color: #52525b;
padding: 8px;
border-radius: 8px;

/* Hover */
background: rgba(18, 58, 255, 0.08);
color: #123aff;
```

---

## 6. ç»„ä»¶è®¾è®¡è§„èŒƒ

### 6.1 å‘½åçº¦å®š

```typescript
// ç»„ä»¶ï¼šPascalCase
export const ChatArea = () => { ... }
export const BranchTreeView = () => { ... }

// Hookï¼šuse å‰ç¼€ + camelCase
export const useProjects = () => { ... }
export const useBranches = () => { ... }

// å·¥å…·å‡½æ•°ï¼šcamelCase
export function parseMessageContent(content: string) { ... }
export function extractFilesFromContent(content: string) { ... }

// ç±»å‹/æ¥å£ï¼šPascalCase
export interface Project { ... }
export interface Branch { ... }
export type MessageRole = "user" | "assistant";

// å¸¸é‡ï¼šUPPER_SNAKE_CASE
const CHAT_URL = `${import.meta.env.VITE_SUPABASE_URL}/functions/v1/chat`;
const CARD_WIDTH = 360;
```

### 6.2 æ–‡ä»¶ç»„ç»‡

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ curve/           # ä¸šåŠ¡ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatArea.tsx
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx
â”‚   â”‚   â”œâ”€â”€ BranchTreeView.tsx
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ layout/          # å¸ƒå±€ç›¸å…³ç»„ä»¶
â”‚   â”‚   â””â”€â”€ CapabilitiesMenu.tsx
â”‚   â””â”€â”€ ui/              # åŸºç¡€ UI ç»„ä»¶ (shadcn/ui)
â”‚       â”œâ”€â”€ button.tsx
â”‚       â”œâ”€â”€ dialog.tsx
â”‚       â””â”€â”€ ...
â”œâ”€â”€ hooks/               # è‡ªå®šä¹‰ Hooks
â”‚   â”œâ”€â”€ useProjects.ts
â”‚   â”œâ”€â”€ useBranches.ts
â”‚   â””â”€â”€ useSmartFolder.ts
â”œâ”€â”€ lib/                 # çº¯å‡½æ•°å·¥å…·
â”‚   â”œâ”€â”€ agents.ts
â”‚   â”œâ”€â”€ messageUtils.ts
â”‚   â””â”€â”€ moleculeDataUtils.ts
â”œâ”€â”€ contexts/            # React Context
â”‚   â””â”€â”€ NavigationContext.tsx
â”œâ”€â”€ pages/               # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ Index.tsx
â”‚   â”œâ”€â”€ Agent.tsx
â”‚   â””â”€â”€ SkillsHub/
â””â”€â”€ layouts/             # å¸ƒå±€ç»„ä»¶
    â””â”€â”€ MainLayout.tsx
```

### 6.3 æ ·å¼ç¼–å†™è§„èŒƒ

```tsx
// âœ… ä½¿ç”¨ Tailwind + cn() å·¥å…·å‡½æ•°
import { cn } from "@/lib/utils";

<div className={cn(
  "base-classes",
  isActive && "active-classes",
  variant === "primary" && "variant-classes"
)} />

// âœ… åŠ¨æ€æ ·å¼ä½¿ç”¨ style å±æ€§
<button
  style={{
    color: isActive ? '#123aff' : '#52525b',
    backgroundColor: isActive ? 'rgba(18, 58, 255, 0.08)' : 'transparent',
  }}
/>

// âœ… å“åº”å¼å¸ƒå±€ä½¿ç”¨ flex + min-w-0
<div className="flex-1 min-w-0 overflow-hidden">

// âŒ é¿å…è¡Œå†…æ ·å¼æ··ç”¨
<div className="text-sm" style={{ fontSize: '14px' }} />
```

### 6.4 ç»„ä»¶ Props è§„èŒƒ

```typescript
// âœ… æ˜ç¡®å®šä¹‰ interface
interface ChatAreaProps {
  projectId: string | null;
  projectName: string;
}

// âœ… è§£æ„å¹¶è®¾ç½®é»˜è®¤å€¼
const ChatArea = ({ projectId, projectName }: ChatAreaProps) => {
  // ...
};

// âœ… å›è°ƒå‡½æ•°å‘½åä½¿ç”¨ on å‰ç¼€
interface ButtonProps {
  onClick?: () => void;
  onHover?: () => void;
  onCreateBranch?: (messageId: string) => void;
}
```

---

## 7. Agent ç³»ç»Ÿ

### 7.1 å¯ç”¨ Agent åˆ—è¡¨

| Agent ID | åç§° | å›¾æ ‡ | ä¸“ä¸šé¢†åŸŸ |
|----------|------|------|----------|
| xtalpi | Xtalpi Agent | ğŸ§ª | åˆ†å­ç»“æ„åˆ†æã€è¯ç‰©ç ”å‘ã€ADMET é¢„æµ‹ |
| research | Research Agent | ğŸ“š | æ–‡çŒ®æ£€ç´¢ã€è®ºæ–‡åˆ†æã€ç ”ç©¶è¶‹åŠ¿ |
| data | Data Agent | ğŸ“Š | æ•°æ®åˆ†æã€ç»Ÿè®¡å»ºæ¨¡ã€å¯è§†åŒ– |
| code | Code Agent | ğŸ’» | ç¼–ç¨‹å¼€å‘ã€ä»£ç å®¡æŸ¥ã€æ¶æ„è®¾è®¡ |

### 7.2 Agent åˆ‡æ¢é€»è¾‘

```
ç”¨æˆ·é€‰æ‹©æ–° Agent
    â†“
æ£€æŸ¥æ˜¯å¦æœ‰å¯¹è¯å†å²
    â”œâ”€ æ— å†å² â†’ ç›´æ¥åˆ‡æ¢
    â””â”€ æœ‰å†å² â†’ å¼¹å‡º AgentSwitchDialog
                 â”œâ”€ ä¿ç•™å†å² â†’ åˆ‡æ¢ Agentï¼Œä¿æŒæ¶ˆæ¯
                 â””â”€ æ¸…ç©ºå†å² â†’ æ¸…ç©ºæ¶ˆæ¯ååˆ‡æ¢
```

### 7.3 ç³»ç»Ÿæç¤ºè¯æ ¼å¼

```
ä½ æ˜¯ [Agent åç§°]ï¼Œä¸€ä¸ªä¸“ä¸šçš„ [é¢†åŸŸæè¿°] AI åŠ©æ‰‹ã€‚

ä½ çš„ä¸“ä¸šé¢†åŸŸåŒ…æ‹¬ï¼š
- [èƒ½åŠ›1]
- [èƒ½åŠ›2]
- [èƒ½åŠ›3]

å›å¤æ ¼å¼è¦æ±‚ï¼š
- ä½¿ç”¨ <reasoning>...</reasoning> æ ‡ç­¾åŒ…è£¹æ¨ç†è¿‡ç¨‹
- ä½¿ç”¨ <tools>...</tools> æ ‡ç­¾åˆ—å‡ºè°ƒç”¨çš„å·¥å…·å’ŒçŸ¥è¯†åº“
- ä½¿ç”¨ <conclusion>...</conclusion> æ ‡ç­¾åŒ…è£¹åˆ†æç»“è®º

å¯ç”¨çš„å·¥å…·ä¸çŸ¥è¯†åº“ï¼š
- [å·¥å…·1]
- [å·¥å…·2]
- [å·¥å…·3]

[å…¶ä»–æŒ‡å¯¼åŸåˆ™]
```

---

## 8. æ•°æ®æ¨¡å‹

### 8.1 æ ¸å¿ƒè¡¨ç»“æ„

```sql
-- é¡¹ç›®è¡¨
projects (
  id UUID PRIMARY KEY,
  name TEXT NOT NULL,
  icon TEXT DEFAULT 'ğŸ”¬',
  description TEXT,
  author TEXT DEFAULT 'Anonymous',
  created_at TIMESTAMPTZ DEFAULT NOW()
)

-- æ¶ˆæ¯è¡¨
messages (
  id UUID PRIMARY KEY,
  project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
  branch_id UUID REFERENCES branches(id),
  role TEXT CHECK (role IN ('user', 'assistant', 'system')),
  content TEXT NOT NULL,
  agent_id TEXT,
  files JSONB,
  collaborator_id UUID REFERENCES collaborators(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
)

-- åˆ†æ”¯è¡¨
branches (
  id UUID PRIMARY KEY,
  project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
  parent_branch_id UUID REFERENCES branches(id),
  branch_point_message_id UUID REFERENCES messages(id),
  name TEXT NOT NULL,
  description TEXT,
  is_main BOOLEAN DEFAULT FALSE,
  created_by UUID,
  created_at TIMESTAMPTZ DEFAULT NOW()
)

-- åä½œè€…è¡¨
collaborators (
  id UUID PRIMARY KEY,
  project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
  name TEXT NOT NULL,
  avatar_color TEXT,
  browser_id TEXT NOT NULL,
  created_at TIMESTAMPTZ DEFAULT NOW()
)

-- æ–‡ä»¶èµ„äº§è¡¨
file_assets (
  id UUID PRIMARY KEY,
  project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
  branch_id UUID REFERENCES branches(id),
  message_id UUID REFERENCES messages(id),
  name TEXT NOT NULL,
  type TEXT NOT NULL,
  category TEXT,
  content TEXT,
  size INTEGER,
  created_at TIMESTAMPTZ DEFAULT NOW()
)
```

### 8.2 æœ¬åœ°ç±»å‹å®šä¹‰

```typescript
interface Project {
  id: string;
  name: string;
  icon: string;
  description: string | null;
  author: string;
  created_at: string;
}

interface Message {
  id: string;
  role: "user" | "assistant";
  content: string;
  timestamp: Date;
  attachments?: MessageAttachment[];
  isStreaming?: boolean;
  collaboratorId?: string;
}

interface Branch {
  id: string;
  project_id: string;
  parent_branch_id: string | null;
  branch_point_message_id: string | null;
  name: string;
  description: string | null;
  is_main: boolean;
  created_at: string;
}
```

---

## é™„å½•ï¼šå¸¸ç”¨è·¯å¾„åˆ«å

```typescript
import { Button } from "@/components/ui/button";
import { useProjects } from "@/hooks/useProjects";
import { parseMessageContent } from "@/lib/messageUtils";
import { supabase } from "@/integrations/supabase/client";
import { cn } from "@/lib/utils";
import { AVAILABLE_AGENTS } from "@/lib/agents";
import { AVAILABLE_SKILLS } from "@/lib/skills";
```

---

æ–‡æ¡£ç‰ˆæœ¬: 1.0  
æ›´æ–°æ—¥æœŸ: 2026-01-08



